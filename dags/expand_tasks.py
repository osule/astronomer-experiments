"""
expand_tasks
DAG auto-generated by Astro Cloud IDE.
"""

from airflow.decorators import dag, task, task_group
import pendulum

# Default arguments for the DAG
default_args = {
    "owner": "Oluwafemi Sule",
}

@dag(
    default_args=default_args,
    schedule_interval="0 0 * * *",  # Cron schedule
    start_date=pendulum.datetime(2024, 12, 4, tz="UTC"),
    catchup=False,
    owner_links={
        "Oluwafemi Sule": "https://cloud.astronomer.io/cm1eu47w413zr01nqex144eth/cloud-ide/cm1eu73d3140701nqx7ces5cz/cm49ulf811oxj01o6bu4tsaxp",
    },
)
def expand_tasks():
    """A DAG demonstrating task group expansion."""

    @task_group(group_id="group1")
    def tg1(my_num):
        """Task group to process a number."""

        @task
        def add_42(num):
            """Adds 42 to the input number."""
            return num + 42

        @task
        def print_num(num):
            """Prints the input number."""
            print(f"Processing number: {num}")
            return num

        # Task dependencies within the task group
        print_num(my_num) >> add_42(my_num)

    # Expanding the task group with a list of input values
    tg1.partial().expand(my_num=[19, 23, 42, 8, 7, 108])

# Instantiate the DAG
dag_obj = expand_tasks()
